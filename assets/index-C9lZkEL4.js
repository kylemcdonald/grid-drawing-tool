var M=Object.defineProperty;var C=(v,e,t)=>e in v?M(v,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):v[e]=t;var c=(v,e,t)=>C(v,typeof e!="symbol"?e+"":e,t);(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const s of document.querySelectorAll('link[rel="modulepreload"]'))o(s);new MutationObserver(s=>{for(const a of s)if(a.type==="childList")for(const l of a.addedNodes)l.tagName==="LINK"&&l.rel==="modulepreload"&&o(l)}).observe(document,{childList:!0,subtree:!0});function t(s){const a={};return s.integrity&&(a.integrity=s.integrity),s.referrerPolicy&&(a.referrerPolicy=s.referrerPolicy),s.crossOrigin==="use-credentials"?a.credentials="include":s.crossOrigin==="anonymous"?a.credentials="omit":a.credentials="same-origin",a}function o(s){if(s.ep)return;s.ep=!0;const a=t(s);fetch(s.href,a)}})();var y=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{},E={exports:{}};(function(v,e){(function(t,o){o()})(y,function(){function t(i,r){return typeof r>"u"?r={autoBom:!1}:typeof r!="object"&&(console.warn("Deprecated: Expected third argument to be a object"),r={autoBom:!r}),r.autoBom&&/^\s*(?:text\/\S*|application\/xml|\S*\/\S*\+xml)\s*;.*charset\s*=\s*utf-8/i.test(i.type)?new Blob(["\uFEFF",i],{type:i.type}):i}function o(i,r,f){var u=new XMLHttpRequest;u.open("GET",i),u.responseType="blob",u.onload=function(){h(u.response,r,f)},u.onerror=function(){console.error("could not download file")},u.send()}function s(i){var r=new XMLHttpRequest;r.open("HEAD",i,!1);try{r.send()}catch{}return 200<=r.status&&299>=r.status}function a(i){try{i.dispatchEvent(new MouseEvent("click"))}catch{var r=document.createEvent("MouseEvents");r.initMouseEvent("click",!0,!0,window,0,0,0,80,20,!1,!1,!1,!1,0,null),i.dispatchEvent(r)}}var l=typeof window=="object"&&window.window===window?window:typeof self=="object"&&self.self===self?self:typeof y=="object"&&y.global===y?y:void 0,n=l.navigator&&/Macintosh/.test(navigator.userAgent)&&/AppleWebKit/.test(navigator.userAgent)&&!/Safari/.test(navigator.userAgent),h=l.saveAs||(typeof window!="object"||window!==l?function(){}:"download"in HTMLAnchorElement.prototype&&!n?function(i,r,f){var u=l.URL||l.webkitURL,p=document.createElement("a");r=r||i.name||"download",p.download=r,p.rel="noopener",typeof i=="string"?(p.href=i,p.origin===location.origin?a(p):s(p.href)?o(i,r,f):a(p,p.target="_blank")):(p.href=u.createObjectURL(i),setTimeout(function(){u.revokeObjectURL(p.href)},4e4),setTimeout(function(){a(p)},0))}:"msSaveOrOpenBlob"in navigator?function(i,r,f){if(r=r||i.name||"download",typeof i!="string")navigator.msSaveOrOpenBlob(t(i,f),r);else if(s(i))o(i,r,f);else{var u=document.createElement("a");u.href=i,u.target="_blank",setTimeout(function(){a(u)})}}:function(i,r,f,u){if(u=u||open("","_blank"),u&&(u.document.title=u.document.body.innerText="downloading..."),typeof i=="string")return o(i,r,f);var p=i.type==="application/octet-stream",L=/constructor/i.test(l.HTMLElement)||l.safari,z=/CriOS\/[\d]+/.test(navigator.userAgent);if((z||p&&L||n)&&typeof FileReader<"u"){var m=new FileReader;m.onloadend=function(){var w=m.result;w=z?w:w.replace(/^data:[^;]*;/,"data:attachment/file;"),u?u.location.href=w:location=w,u=null},m.readAsDataURL(i)}else{var P=l.URL||l.webkitURL,S=P.createObjectURL(i);u?u.location=S:location.href=S,u=null,setTimeout(function(){P.revokeObjectURL(S)},4e4)}});l.saveAs=h.saveAs=h,v.exports=h})})(E);var b=E.exports;const g=26,d=12;class A{constructor(e,t){c(this,"grid");c(this,"onChange");this.grid=e,this.onChange=t}updatePixel(e,t,o="black"){const s=this.grid.map(a=>[...a]);s[e][t]=o,this.grid=s,this.onChange(s)}getGrid(){return this.grid.map(e=>[...e])}setGrid(e){this.grid=e.map(t=>[...t]),this.onChange(this.grid)}}const k=()=>Array(g).fill(null).map(()=>Array(g).fill(null).map(()=>"clear")),x=v=>{const e=JSON.stringify(v);let t=0;for(let o=0;o<e.length;o++){const s=e.charCodeAt(o);t=(t<<5)-t+s,t=t&t}return Math.abs(t).toString(16).slice(0,8)},T=(v,e,t,o,s)=>{const a=Math.abs(t-v),l=Math.abs(o-e),n=v<t?1:-1,h=e<o?1:-1;let i=a-l;for(;s(v,e),!(v===t&&e===o);){const r=2*i;r>-l&&(i-=l,v+=n),r<a&&(i+=a,e+=h)}};class ${constructor(){c(this,"baseCanvas");c(this,"overlayCanvas");c(this,"canvasContainer");c(this,"grid");c(this,"gridManager");c(this,"backgroundImage",null);c(this,"pixelSize",32);c(this,"canvasSize",g*this.pixelSize);c(this,"drawingState",{isDrawing:!1,hoverRegion:null});c(this,"drawingMode","black");c(this,"lastPosition",null);c(this,"previousPosition",null);c(this,"hoverPosition",null);c(this,"mousePosition",null);c(this,"keyboardPosition",null);c(this,"history",[]);c(this,"historyIndex",-1);c(this,"handleMouseDown",e=>{const t=this.getMousePosition(e);if(!t)return;this.drawingState.isDrawing=!0,this.drawingState.hoverRegion=t.region,this.lastPosition=t,this.previousPosition=t,this.hoverPosition=t;const o=t.region==="center"?"black":t.region;this.grid[t.row][t.col]!==o&&(this.gridManager.updatePixel(t.row,t.col,o),this.saveToHistory())});c(this,"handleMouseMove",e=>{const t=this.baseCanvas.getBoundingClientRect(),o=e.clientX-t.left,s=e.clientY-t.top;this.mousePosition={x:o,y:s};const a=this.getMousePosition(e);if(a){if(this.drawingState.isDrawing&&this.previousPosition){this.hoverPosition={...a,region:this.drawingState.hoverRegion||a.region};const l=this.drawingState.hoverRegion==="center"?"black":this.drawingState.hoverRegion||a.region;let n=!1;T(this.previousPosition.col,this.previousPosition.row,a.col,a.row,(h,i)=>{h>=0&&h<g&&i>=0&&i<g&&this.grid[i][h]!==l&&(this.gridManager.updatePixel(i,h,l),n=!0)}),n&&this.saveToHistory(),this.previousPosition=a}else this.hoverPosition=a;this.drawOverlay()}});c(this,"handleMouseUp",()=>{if(this.drawingState.isDrawing){const e=JSON.stringify(this.grid),t=this.historyIndex>=0?JSON.stringify(this.history[this.historyIndex]):null;e!==t&&this.saveToHistory()}this.drawingState.isDrawing=!1,this.lastPosition=null,this.previousPosition=null});c(this,"handleMouseLeave",()=>{this.hoverPosition=null,this.mousePosition=null,this.drawOverlay()});c(this,"exportAsPNG",()=>{const e=x(this.grid),t=document.createElement("canvas"),o=g*32;t.width=o,t.height=o;const s=t.getContext("2d");s&&(s.fillStyle="white",s.fillRect(0,0,o,o),this.grid.forEach((a,l)=>{a.forEach((n,h)=>{const i=h*32,r=l*32;if(n==="black")s.fillStyle="black",s.fillRect(i,r,32,32);else if(n!=="clear"){switch(s.fillStyle="black",s.beginPath(),n){case"top-left":s.moveTo(i,r),s.lineTo(i,r+32),s.lineTo(i+32,r);break;case"top-right":s.moveTo(i,r),s.lineTo(i+32,r),s.lineTo(i+32,r+32);break;case"bottom-left":s.moveTo(i,r),s.lineTo(i,r+32),s.lineTo(i+32,r+32);break;case"bottom-right":s.moveTo(i+32,r),s.lineTo(i,r+32),s.lineTo(i+32,r+32);break}s.closePath(),s.fill()}})}),t.toBlob(a=>{a&&b.saveAs(a,`${e}.png`)}))});c(this,"exportAsSVG",()=>{const e=x(this.grid),t=document.createElementNS("http://www.w3.org/2000/svg","svg"),o=g*d;t.setAttribute("width",`${o}`),t.setAttribute("height",`${o}`),t.setAttribute("viewBox",`0 0 ${o} ${o}`),this.grid.forEach((l,n)=>{l.forEach((h,i)=>{if(h==="black"){const r=document.createElementNS("http://www.w3.org/2000/svg","rect");r.setAttribute("x",`${i*d}`),r.setAttribute("y",`${n*d}`),r.setAttribute("width",`${d}`),r.setAttribute("height",`${d}`),r.setAttribute("fill","black"),t.appendChild(r)}else if(h!=="clear"){const r=document.createElementNS("http://www.w3.org/2000/svg","path"),f={"top-left":`M${i*d},${n*d} L${i*d},${(n+1)*d} L${(i+1)*d},${n*d} Z`,"top-right":`M${i*d},${n*d} L${(i+1)*d},${n*d} L${(i+1)*d},${(n+1)*d} Z`,"bottom-left":`M${i*d},${n*d} L${i*d},${(n+1)*d} L${(i+1)*d},${(n+1)*d} Z`,"bottom-right":`M${(i+1)*d},${(n+1)*d} L${i*d},${(n+1)*d} L${(i+1)*d},${n*d} Z`};r.setAttribute("d",f[h]),r.setAttribute("fill","black"),t.appendChild(r)}})});const s=new XMLSerializer().serializeToString(t),a=new Blob([s],{type:"image/svg+xml"});b.saveAs(a,`${e}.svg`)});c(this,"exportAsJSON",()=>{const e=x(this.grid),t={version:1,grid:this.grid},o=new Blob([JSON.stringify(t)],{type:"application/json"});b.saveAs(o,`${e}.json`)});c(this,"exportAll",()=>{this.exportAsPNG(),this.exportAsSVG(),this.exportAsJSON()});c(this,"handleFileDrop",e=>{var o;e.preventDefault();const t=(o=e.dataTransfer)==null?void 0:o.files[0];if(t){if(t.type==="application/json"){const s=new FileReader;s.onload=a=>{var l;try{const n=JSON.parse((l=a.target)==null?void 0:l.result),h=n.version===1?n.grid:n;this.gridManager.setGrid(h)}catch(n){console.error("Error loading file:",n)}},s.readAsText(t)}else if(t.type.startsWith("image/")){const s=new FileReader;s.onload=a=>{var n;const l=new Image;l.onload=()=>{this.backgroundImage=l,document.getElementById("clear-background").style.display="block",this.drawBase()},l.src=(n=a.target)==null?void 0:n.result},s.readAsDataURL(t)}}});c(this,"clearBackground",()=>{this.backgroundImage=null,document.getElementById("clear-background").style.display="none",this.drawBase()});c(this,"invertPixels",()=>{const e=this.grid.map(s=>s.map(a=>a==="clear"?"black":a==="black"?"clear":{"top-left":"bottom-right","top-right":"bottom-left","bottom-left":"top-right","bottom-right":"top-left"}[a])),t=JSON.stringify(this.grid),o=JSON.stringify(e);t!==o&&(this.gridManager.setGrid(e),this.saveToHistory())});this.baseCanvas=document.getElementById("base-canvas"),this.overlayCanvas=document.getElementById("overlay-canvas"),this.canvasContainer=document.querySelector(".canvas-container"),this.grid=k(),this.gridManager=new A(this.grid,e=>{this.grid=e,this.drawBase()}),this.initializeEventListeners(),this.updatePixelSize(),window.addEventListener("resize",()=>this.updatePixelSize()),this.saveToHistory()}updatePixelSize(){const e=window.innerHeight;this.pixelSize=Math.floor((e-100)/g),this.canvasSize=g*this.pixelSize,this.canvasContainer.style.width=`${this.canvasSize}px`,this.canvasContainer.style.height=`${this.canvasSize}px`;const t=window.devicePixelRatio||1;this.baseCanvas.width=this.canvasSize*t,this.baseCanvas.height=this.canvasSize*t,this.overlayCanvas.width=this.canvasSize*t,this.overlayCanvas.height=this.canvasSize*t;const o=this.baseCanvas.getContext("2d"),s=this.overlayCanvas.getContext("2d");o&&s&&(o.scale(t,t),s.scale(t,t)),this.baseCanvas.style.width=`${this.canvasSize}px`,this.baseCanvas.style.height=`${this.canvasSize}px`,this.overlayCanvas.style.width=`${this.canvasSize}px`,this.overlayCanvas.style.height=`${this.canvasSize}px`,this.drawBase()}drawBase(){const e=this.baseCanvas.getContext("2d");if(e){e.clearRect(0,0,this.canvasSize,this.canvasSize),e.fillStyle="white",e.fillRect(0,0,this.canvasSize,this.canvasSize),this.backgroundImage&&(e.globalAlpha=.5,e.drawImage(this.backgroundImage,0,0,this.canvasSize,this.canvasSize),e.globalAlpha=1),e.strokeStyle="#cccccc",e.lineWidth=.5,e.translate(.25,.25),e.beginPath();for(let t=0;t<=g;t++){const o=t*this.pixelSize,s=(g-t)*this.pixelSize;t>0&&t<g&&(e.moveTo(o,0),e.lineTo(o,this.canvasSize),e.moveTo(0,o),e.lineTo(this.canvasSize,o)),e.moveTo(o,0),e.lineTo(this.canvasSize,s),e.moveTo(s,0),e.lineTo(0,s),t>0&&(e.moveTo(0,o),e.lineTo(s,this.canvasSize),e.moveTo(this.canvasSize,s),e.lineTo(s,this.canvasSize))}e.stroke(),e.translate(-.25,-.25),e.fillStyle="black",this.grid.forEach((t,o)=>{t.forEach((s,a)=>{if(s==="clear")return;const l=a*this.pixelSize,n=o*this.pixelSize;if(s==="black")e.fillRect(l,n,this.pixelSize,this.pixelSize);else{switch(e.beginPath(),s){case"top-left":e.moveTo(l,n),e.lineTo(l,n+this.pixelSize),e.lineTo(l+this.pixelSize,n);break;case"top-right":e.moveTo(l,n),e.lineTo(l+this.pixelSize,n),e.lineTo(l+this.pixelSize,n+this.pixelSize);break;case"bottom-left":e.moveTo(l,n),e.lineTo(l,n+this.pixelSize),e.lineTo(l+this.pixelSize,n+this.pixelSize);break;case"bottom-right":e.moveTo(l+this.pixelSize,n),e.lineTo(l,n+this.pixelSize),e.lineTo(l+this.pixelSize,n+this.pixelSize);break}e.closePath(),e.fill()}})})}}drawOverlay(){const e=this.overlayCanvas.getContext("2d");if(e){if(e.clearRect(0,0,this.canvasSize,this.canvasSize),this.hoverPosition){const t=this.hoverPosition.col*this.pixelSize,o=this.hoverPosition.row*this.pixelSize;e.fillStyle="rgba(255, 0, 0, 0.3)";const s=this.drawingState.isDrawing?this.drawingState.hoverRegion||this.hoverPosition.region:this.hoverPosition.region;if(s==="black"||s==="center"||s==="clear")e.fillRect(t,o,this.pixelSize,this.pixelSize);else{switch(e.beginPath(),s){case"top-left":e.moveTo(t,o),e.lineTo(t,o+this.pixelSize),e.lineTo(t+this.pixelSize,o);break;case"top-right":e.moveTo(t,o),e.lineTo(t+this.pixelSize,o),e.lineTo(t+this.pixelSize,o+this.pixelSize);break;case"bottom-left":e.moveTo(t,o),e.lineTo(t,o+this.pixelSize),e.lineTo(t+this.pixelSize,o+this.pixelSize);break;case"bottom-right":e.moveTo(t+this.pixelSize,o),e.lineTo(t,o+this.pixelSize),e.lineTo(t+this.pixelSize,o+this.pixelSize);break}e.closePath(),e.fill()}}this.mousePosition&&(e.fillStyle="red",e.beginPath(),e.arc(this.mousePosition.x,this.mousePosition.y,2,0,Math.PI*2),e.fill())}}getMousePosition(e){const t=this.baseCanvas.getBoundingClientRect(),o=e.clientX-t.left,s=e.clientY-t.top,a=Math.floor(o/this.pixelSize),l=Math.floor(s/this.pixelSize);if(a<0||a>=g||l<0||l>=g)return null;const n=o%this.pixelSize/this.pixelSize,h=s%this.pixelSize/this.pixelSize;let i;return n+h<.5?i="top-left":n+h>1.5?i="bottom-right":n-h>.5?i="top-right":h-n>.5?i="bottom-left":i="center",{row:l,col:a,region:i}}saveToHistory(){const e=JSON.stringify(this.grid),t=this.historyIndex>=0?JSON.stringify(this.history[this.historyIndex]):null;e!==t&&(this.history=this.history.slice(0,this.historyIndex+1),this.history.push(this.grid.map(o=>[...o])),this.historyIndex++,this.history.length>100&&(this.history=this.history.slice(-100),this.historyIndex=this.history.length-1))}undo(){this.historyIndex>0&&(this.historyIndex--,this.grid=this.history[this.historyIndex].map(e=>[...e]),this.gridManager.setGrid(this.grid))}redo(){this.historyIndex<this.history.length-1&&(this.historyIndex++,this.grid=this.history[this.historyIndex].map(e=>[...e]),this.gridManager.setGrid(this.grid))}shiftGrid(e){const t=k();for(let o=0;o<g;o++)for(let s=0;s<g;s++){let a=o,l=s;switch(e){case"up":a=(o+1)%g;break;case"down":a=(o-1+g)%g;break;case"left":l=(s+1)%g;break;case"right":l=(s-1+g)%g;break}t[o][s]=this.grid[a][l]}this.gridManager.setGrid(t),this.saveToHistory()}initializeEventListeners(){var e,t,o,s,a,l;this.baseCanvas.addEventListener("mousedown",this.handleMouseDown),this.baseCanvas.addEventListener("mousemove",this.handleMouseMove),this.baseCanvas.addEventListener("mouseup",this.handleMouseUp),this.baseCanvas.addEventListener("mouseleave",this.handleMouseLeave),this.overlayCanvas.addEventListener("mousedown",this.handleMouseDown),this.overlayCanvas.addEventListener("mousemove",this.handleMouseMove),this.overlayCanvas.addEventListener("mouseup",this.handleMouseUp),this.overlayCanvas.addEventListener("mouseleave",this.handleMouseLeave),document.addEventListener("keydown",n=>{const h=n.key.toLowerCase();let i=null;if(h==="z"&&(n.ctrlKey||n.metaKey)){n.shiftKey?this.redo():this.undo();return}switch(h){case"arrowup":this.shiftGrid("up");return;case"arrowdown":this.shiftGrid("down");return;case"arrowleft":this.shiftGrid("left");return;case"arrowright":this.shiftGrid("right");return;case"z":i="black";break;case"y":if(n.ctrlKey||n.metaKey){this.redo();return}break;case"x":i="clear";break;case"q":i="bottom-right";break;case"w":i="bottom-left";break;case"a":i="top-right";break;case"s":i="top-left";break}i!==null&&(this.drawingState.isDrawing=!0,this.drawingMode=i,this.drawingState.hoverRegion=i,this.drawOverlay()),i!==null&&this.hoverPosition&&this.grid[this.hoverPosition.row][this.hoverPosition.col]!==i&&(this.keyboardPosition={row:this.hoverPosition.row,col:this.hoverPosition.col},this.gridManager.updatePixel(this.hoverPosition.row,this.hoverPosition.col,i),this.saveToHistory())}),document.addEventListener("keyup",n=>{const h=n.key.toLowerCase();if(["z","x","q","w","a","s"].includes(h)){if(this.drawingState.isDrawing){const i=JSON.stringify(this.grid),r=this.historyIndex>=0?JSON.stringify(this.history[this.historyIndex]):null;i!==r&&this.saveToHistory()}this.drawingState.isDrawing=!1,this.keyboardPosition=null}}),document.addEventListener("mousemove",n=>{if(this.drawingState.isDrawing&&this.keyboardPosition&&this.hoverPosition){let h=!1;T(this.keyboardPosition.col,this.keyboardPosition.row,this.hoverPosition.col,this.hoverPosition.row,(i,r)=>{i>=0&&i<g&&r>=0&&r<g&&this.grid[r][i]!==this.drawingMode&&(this.gridManager.updatePixel(r,i,this.drawingMode),h=!0)}),h&&this.saveToHistory(),this.keyboardPosition={row:this.hoverPosition.row,col:this.hoverPosition.col}}}),(e=document.getElementById("export-png"))==null||e.addEventListener("click",this.exportAsPNG),(t=document.getElementById("export-svg"))==null||t.addEventListener("click",this.exportAsSVG),(o=document.getElementById("export-json"))==null||o.addEventListener("click",this.exportAsJSON),(s=document.getElementById("export-all"))==null||s.addEventListener("click",this.exportAll),(a=document.getElementById("clear-background"))==null||a.addEventListener("click",this.clearBackground),(l=document.getElementById("invert-colors"))==null||l.addEventListener("click",this.invertPixels),document.addEventListener("dragover",n=>n.preventDefault()),document.addEventListener("drop",this.handleFileDrop)}}new $;
