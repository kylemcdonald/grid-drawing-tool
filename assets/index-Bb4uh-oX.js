var T=Object.defineProperty;var M=(p,e,t)=>e in p?T(p,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):p[e]=t;var h=(p,e,t)=>M(p,typeof e!="symbol"?e+"":e,t);(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const o of document.querySelectorAll('link[rel="modulepreload"]'))s(o);new MutationObserver(o=>{for(const l of o)if(l.type==="childList")for(const r of l.addedNodes)r.tagName==="LINK"&&r.rel==="modulepreload"&&s(r)}).observe(document,{childList:!0,subtree:!0});function t(o){const l={};return o.integrity&&(l.integrity=o.integrity),o.referrerPolicy&&(l.referrerPolicy=o.referrerPolicy),o.crossOrigin==="use-credentials"?l.credentials="include":o.crossOrigin==="anonymous"?l.credentials="omit":l.credentials="same-origin",l}function s(o){if(o.ep)return;o.ep=!0;const l=t(o);fetch(o.href,l)}})();var w=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{},E={exports:{}};(function(p,e){(function(t,s){s()})(w,function(){function t(i,a){return typeof a>"u"?a={autoBom:!1}:typeof a!="object"&&(console.warn("Deprecated: Expected third argument to be a object"),a={autoBom:!a}),a.autoBom&&/^\s*(?:text\/\S*|application\/xml|\S*\/\S*\+xml)\s*;.*charset\s*=\s*utf-8/i.test(i.type)?new Blob(["\uFEFF",i],{type:i.type}):i}function s(i,a,v){var u=new XMLHttpRequest;u.open("GET",i),u.responseType="blob",u.onload=function(){c(u.response,a,v)},u.onerror=function(){console.error("could not download file")},u.send()}function o(i){var a=new XMLHttpRequest;a.open("HEAD",i,!1);try{a.send()}catch{}return 200<=a.status&&299>=a.status}function l(i){try{i.dispatchEvent(new MouseEvent("click"))}catch{var a=document.createEvent("MouseEvents");a.initMouseEvent("click",!0,!0,window,0,0,0,80,20,!1,!1,!1,!1,0,null),i.dispatchEvent(a)}}var r=typeof window=="object"&&window.window===window?window:typeof self=="object"&&self.self===self?self:typeof w=="object"&&w.global===w?w:void 0,n=r.navigator&&/Macintosh/.test(navigator.userAgent)&&/AppleWebKit/.test(navigator.userAgent)&&!/Safari/.test(navigator.userAgent),c=r.saveAs||(typeof window!="object"||window!==r?function(){}:"download"in HTMLAnchorElement.prototype&&!n?function(i,a,v){var u=r.URL||r.webkitURL,f=document.createElement("a");a=a||i.name||"download",f.download=a,f.rel="noopener",typeof i=="string"?(f.href=i,f.origin===location.origin?l(f):o(f.href)?s(i,a,v):l(f,f.target="_blank")):(f.href=u.createObjectURL(i),setTimeout(function(){u.revokeObjectURL(f.href)},4e4),setTimeout(function(){l(f)},0))}:"msSaveOrOpenBlob"in navigator?function(i,a,v){if(a=a||i.name||"download",typeof i!="string")navigator.msSaveOrOpenBlob(t(i,v),a);else if(o(i))s(i,a,v);else{var u=document.createElement("a");u.href=i,u.target="_blank",setTimeout(function(){l(u)})}}:function(i,a,v,u){if(u=u||open("","_blank"),u&&(u.document.title=u.document.body.innerText="downloading..."),typeof i=="string")return s(i,a,v);var f=i.type==="application/octet-stream",L=/constructor/i.test(r.HTMLElement)||r.safari,P=/CriOS\/[\d]+/.test(navigator.userAgent);if((P||f&&L||n)&&typeof FileReader<"u"){var b=new FileReader;b.onloadend=function(){var m=b.result;m=P?m:m.replace(/^data:[^;]*;/,"data:attachment/file;"),u?u.location.href=m:location=m,u=null},b.readAsDataURL(i)}else{var z=r.URL||r.webkitURL,S=z.createObjectURL(i);u?u.location=S:location.href=S,u=null,setTimeout(function(){z.revokeObjectURL(S)},4e4)}});r.saveAs=c.saveAs=c,p.exports=c})})(E);var y=E.exports;const g=26,d=12;class A{constructor(e,t){h(this,"grid");h(this,"onChange");this.grid=e,this.onChange=t}updatePixel(e,t,s="black"){const o=this.grid.map(l=>[...l]);o[e][t]=s,this.grid=o,this.onChange(o)}getGrid(){return this.grid.map(e=>[...e])}setGrid(e){this.grid=e.map(t=>[...t]),this.onChange(this.grid)}}const C=()=>Array(g).fill(null).map(()=>Array(g).fill(null).map(()=>"clear")),x=p=>{const e=JSON.stringify(p);let t=0;for(let s=0;s<e.length;s++){const o=e.charCodeAt(s);t=(t<<5)-t+o,t=t&t}return Math.abs(t).toString(16).slice(0,8)},k=(p,e,t,s,o)=>{const l=Math.abs(t-p),r=Math.abs(s-e),n=p<t?1:-1,c=e<s?1:-1;let i=l-r;for(;o(p,e),!(p===t&&e===s);){const a=2*i;a>-r&&(i-=r,p+=n),a<l&&(i+=l,e+=c)}};class ${constructor(){h(this,"baseCanvas");h(this,"overlayCanvas");h(this,"canvasContainer");h(this,"grid");h(this,"gridManager");h(this,"backgroundImage",null);h(this,"pixelSize",32);h(this,"canvasSize",g*this.pixelSize);h(this,"drawingState",{isDrawing:!1,hoverRegion:null});h(this,"drawingMode","black");h(this,"lastPosition",null);h(this,"previousPosition",null);h(this,"hoverPosition",null);h(this,"mousePosition",null);h(this,"keyboardPosition",null);h(this,"handleMouseDown",e=>{const t=this.getMousePosition(e);if(!t)return;this.drawingState.isDrawing=!0,this.drawingState.hoverRegion=t.region,this.lastPosition=t,this.previousPosition=t,this.hoverPosition=t;const s=t.region==="center"?"black":t.region;this.gridManager.updatePixel(t.row,t.col,s)});h(this,"handleMouseMove",e=>{var r,n,c;const t=this.baseCanvas.getBoundingClientRect(),s=e.clientX-t.left,o=e.clientY-t.top;this.mousePosition={x:s,y:o};const l=this.getMousePosition(e);if(l){if(this.drawingState.isDrawing&&this.previousPosition){this.hoverPosition={...l,region:((r=this.lastPosition)==null?void 0:r.region)||l.region};const i=((n=this.lastPosition)==null?void 0:n.region)==="center"?"black":((c=this.lastPosition)==null?void 0:c.region)||l.region;k(this.previousPosition.col,this.previousPosition.row,l.col,l.row,(a,v)=>{a>=0&&a<g&&v>=0&&v<g&&this.gridManager.updatePixel(v,a,i)}),this.previousPosition=l}else this.hoverPosition=l;this.drawOverlay()}});h(this,"handleMouseUp",()=>{this.drawingState.isDrawing=!1,this.lastPosition=null,this.previousPosition=null});h(this,"handleMouseLeave",()=>{this.hoverPosition=null,this.mousePosition=null,this.drawOverlay()});h(this,"exportAsPNG",()=>{const e=x(this.grid),t=document.createElement("canvas"),s=g*32;t.width=s,t.height=s;const o=t.getContext("2d");o&&(o.fillStyle="white",o.fillRect(0,0,s,s),this.grid.forEach((l,r)=>{l.forEach((n,c)=>{const i=c*32,a=r*32;if(n==="black")o.fillStyle="black",o.fillRect(i,a,32,32);else if(n!=="clear"){switch(o.fillStyle="black",o.beginPath(),n){case"top-left":o.moveTo(i,a),o.lineTo(i,a+32),o.lineTo(i+32,a);break;case"top-right":o.moveTo(i,a),o.lineTo(i+32,a),o.lineTo(i+32,a+32);break;case"bottom-left":o.moveTo(i,a),o.lineTo(i,a+32),o.lineTo(i+32,a+32);break;case"bottom-right":o.moveTo(i+32,a),o.lineTo(i,a+32),o.lineTo(i+32,a+32);break}o.closePath(),o.fill()}})}),t.toBlob(l=>{l&&y.saveAs(l,`${e}.png`)}))});h(this,"exportAsSVG",()=>{const e=x(this.grid),t=document.createElementNS("http://www.w3.org/2000/svg","svg"),s=g*d;t.setAttribute("width",`${s}`),t.setAttribute("height",`${s}`),t.setAttribute("viewBox",`0 0 ${s} ${s}`),this.grid.forEach((r,n)=>{r.forEach((c,i)=>{if(c==="black"){const a=document.createElementNS("http://www.w3.org/2000/svg","rect");a.setAttribute("x",`${i*d}`),a.setAttribute("y",`${n*d}`),a.setAttribute("width",`${d}`),a.setAttribute("height",`${d}`),a.setAttribute("fill","black"),t.appendChild(a)}else if(c!=="clear"){const a=document.createElementNS("http://www.w3.org/2000/svg","path"),v={"top-left":`M${i*d},${n*d} L${i*d},${(n+1)*d} L${(i+1)*d},${n*d} Z`,"top-right":`M${i*d},${n*d} L${(i+1)*d},${n*d} L${(i+1)*d},${(n+1)*d} Z`,"bottom-left":`M${i*d},${n*d} L${i*d},${(n+1)*d} L${(i+1)*d},${(n+1)*d} Z`,"bottom-right":`M${(i+1)*d},${(n+1)*d} L${i*d},${(n+1)*d} L${(i+1)*d},${n*d} Z`};a.setAttribute("d",v[c]),a.setAttribute("fill","black"),t.appendChild(a)}})});const o=new XMLSerializer().serializeToString(t),l=new Blob([o],{type:"image/svg+xml"});y.saveAs(l,`${e}.svg`)});h(this,"exportAsJSON",()=>{const e=x(this.grid),t={version:1,grid:this.grid},s=new Blob([JSON.stringify(t)],{type:"application/json"});y.saveAs(s,`${e}.json`)});h(this,"exportAll",()=>{this.exportAsPNG(),this.exportAsSVG(),this.exportAsJSON()});h(this,"handleFileDrop",e=>{var s;e.preventDefault();const t=(s=e.dataTransfer)==null?void 0:s.files[0];if(t){if(t.type==="application/json"){const o=new FileReader;o.onload=l=>{var r;try{const n=JSON.parse((r=l.target)==null?void 0:r.result),c=n.version===1?n.grid:n;this.gridManager.setGrid(c)}catch(n){console.error("Error loading file:",n)}},o.readAsText(t)}else if(t.type.startsWith("image/")){const o=new FileReader;o.onload=l=>{var n;const r=new Image;r.onload=()=>{this.backgroundImage=r,document.getElementById("clear-background").style.display="block",this.drawBase()},r.src=(n=l.target)==null?void 0:n.result},o.readAsDataURL(t)}}});h(this,"clearBackground",()=>{this.backgroundImage=null,document.getElementById("clear-background").style.display="none",this.drawBase()});h(this,"invertPixels",()=>{const e=this.grid.map(t=>t.map(s=>s==="clear"?"black":s==="black"?"clear":{"top-left":"bottom-right","top-right":"bottom-left","bottom-left":"top-right","bottom-right":"top-left"}[s]));this.gridManager.setGrid(e)});this.baseCanvas=document.getElementById("base-canvas"),this.overlayCanvas=document.getElementById("overlay-canvas"),this.canvasContainer=document.querySelector(".canvas-container"),this.grid=C(),this.gridManager=new A(this.grid,e=>{this.grid=e,this.drawBase()}),this.initializeEventListeners(),this.updatePixelSize(),window.addEventListener("resize",()=>this.updatePixelSize())}updatePixelSize(){const e=window.innerHeight;this.pixelSize=Math.floor((e-100)/g),this.canvasSize=g*this.pixelSize,this.canvasContainer.style.width=`${this.canvasSize}px`,this.canvasContainer.style.height=`${this.canvasSize}px`,this.baseCanvas.width=this.canvasSize,this.baseCanvas.height=this.canvasSize,this.overlayCanvas.width=this.canvasSize,this.overlayCanvas.height=this.canvasSize,this.drawBase()}drawBase(){const e=this.baseCanvas.getContext("2d");if(e){e.clearRect(0,0,this.canvasSize,this.canvasSize),e.fillStyle="white",e.fillRect(0,0,this.canvasSize,this.canvasSize),this.backgroundImage&&(e.globalAlpha=.5,e.drawImage(this.backgroundImage,0,0,this.canvasSize,this.canvasSize),e.globalAlpha=1),e.strokeStyle="#cccccc",e.lineWidth=1,e.beginPath();for(let t=0;t<=g;t++){const s=t*this.pixelSize-.5;e.moveTo(s,0),e.lineTo(s,this.canvasSize)}e.stroke(),e.beginPath();for(let t=0;t<=g;t++){const s=t*this.pixelSize-.5;e.moveTo(0,s),e.lineTo(this.canvasSize,s)}e.stroke(),e.fillStyle="black",this.grid.forEach((t,s)=>{t.forEach((o,l)=>{const r=l*this.pixelSize,n=s*this.pixelSize;if(o==="black")e.fillRect(r,n,this.pixelSize,this.pixelSize);else if(o!=="clear"){switch(e.beginPath(),o){case"top-left":e.moveTo(r,n),e.lineTo(r,n+this.pixelSize),e.lineTo(r+this.pixelSize,n);break;case"top-right":e.moveTo(r,n),e.lineTo(r+this.pixelSize,n),e.lineTo(r+this.pixelSize,n+this.pixelSize);break;case"bottom-left":e.moveTo(r,n),e.lineTo(r,n+this.pixelSize),e.lineTo(r+this.pixelSize,n+this.pixelSize);break;case"bottom-right":e.moveTo(r+this.pixelSize,n),e.lineTo(r,n+this.pixelSize),e.lineTo(r+this.pixelSize,n+this.pixelSize);break}e.closePath(),e.fill()}})})}}drawOverlay(){const e=this.overlayCanvas.getContext("2d");if(e){if(e.clearRect(0,0,this.canvasSize,this.canvasSize),this.hoverPosition){const t=this.hoverPosition.col*this.pixelSize,s=this.hoverPosition.row*this.pixelSize;e.fillStyle="rgba(255, 0, 0, 0.3)";const o=this.drawingState.isDrawing?this.drawingMode:this.hoverPosition.region;if(o==="black"||o==="center"||o==="clear")e.fillRect(t,s,this.pixelSize,this.pixelSize);else{switch(e.beginPath(),o){case"top-left":e.moveTo(t,s),e.lineTo(t,s+this.pixelSize),e.lineTo(t+this.pixelSize,s);break;case"top-right":e.moveTo(t,s),e.lineTo(t+this.pixelSize,s),e.lineTo(t+this.pixelSize,s+this.pixelSize);break;case"bottom-left":e.moveTo(t,s),e.lineTo(t,s+this.pixelSize),e.lineTo(t+this.pixelSize,s+this.pixelSize);break;case"bottom-right":e.moveTo(t+this.pixelSize,s),e.lineTo(t,s+this.pixelSize),e.lineTo(t+this.pixelSize,s+this.pixelSize);break}e.closePath(),e.fill()}}this.mousePosition&&(e.fillStyle="red",e.beginPath(),e.arc(this.mousePosition.x,this.mousePosition.y,2,0,Math.PI*2),e.fill())}}getMousePosition(e){const t=this.baseCanvas.getBoundingClientRect(),s=e.clientX-t.left,o=e.clientY-t.top,l=Math.floor(s/this.pixelSize),r=Math.floor(o/this.pixelSize);if(l<0||l>=g||r<0||r>=g)return null;const n=s%this.pixelSize/this.pixelSize,c=o%this.pixelSize/this.pixelSize;let i;return n+c<.5?i="top-left":n+c>1.5?i="bottom-right":n-c>.5?i="top-right":c-n>.5?i="bottom-left":i="center",{row:r,col:l,region:i}}initializeEventListeners(){var e,t,s,o,l,r;this.baseCanvas.addEventListener("mousedown",this.handleMouseDown),this.baseCanvas.addEventListener("mousemove",this.handleMouseMove),this.baseCanvas.addEventListener("mouseup",this.handleMouseUp),this.baseCanvas.addEventListener("mouseleave",this.handleMouseLeave),this.overlayCanvas.addEventListener("mousedown",this.handleMouseDown),this.overlayCanvas.addEventListener("mousemove",this.handleMouseMove),this.overlayCanvas.addEventListener("mouseup",this.handleMouseUp),this.overlayCanvas.addEventListener("mouseleave",this.handleMouseLeave),document.addEventListener("keydown",n=>{if(!this.hoverPosition)return;const c=n.key.toLowerCase();let i=null;switch(c){case"z":i="black";break;case"x":i="clear";break;case"q":i="bottom-right";break;case"w":i="bottom-left";break;case"a":i="top-right";break;case"s":i="top-left";break}i!==null&&(this.drawingState.isDrawing=!0,this.drawingMode=i,this.keyboardPosition={row:this.hoverPosition.row,col:this.hoverPosition.col},this.gridManager.updatePixel(this.hoverPosition.row,this.hoverPosition.col,i))}),document.addEventListener("keyup",n=>{const c=n.key.toLowerCase();["z","x","q","w","a","s"].includes(c)&&(this.drawingState.isDrawing=!1,this.keyboardPosition=null)}),document.addEventListener("mousemove",n=>{this.drawingState.isDrawing&&this.keyboardPosition&&this.hoverPosition&&(k(this.keyboardPosition.col,this.keyboardPosition.row,this.hoverPosition.col,this.hoverPosition.row,(c,i)=>{c>=0&&c<g&&i>=0&&i<g&&this.gridManager.updatePixel(i,c,this.drawingMode)}),this.keyboardPosition={row:this.hoverPosition.row,col:this.hoverPosition.col})}),(e=document.getElementById("export-png"))==null||e.addEventListener("click",this.exportAsPNG),(t=document.getElementById("export-svg"))==null||t.addEventListener("click",this.exportAsSVG),(s=document.getElementById("export-json"))==null||s.addEventListener("click",this.exportAsJSON),(o=document.getElementById("export-all"))==null||o.addEventListener("click",this.exportAll),(l=document.getElementById("clear-background"))==null||l.addEventListener("click",this.clearBackground),(r=document.getElementById("invert-colors"))==null||r.addEventListener("click",this.invertPixels),document.addEventListener("dragover",n=>n.preventDefault()),document.addEventListener("drop",this.handleFileDrop)}}new $;
